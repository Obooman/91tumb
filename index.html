<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Tumblr/91porn downloader</title>
	<style>
		html{
			height: 100%;
			font-size: 0px;
			overflow: hidden;
		}

		body{
			background-color: #4ADE8F;
			display: flex;
			align-items: center;
			justify-content: center;
			box-sizing: border-box;
			height: 100%;
		}

		.button{
			width: 400px;
			height: 200px;
			background-color: #C46290;
			color: white;
			text-align: center;
			line-height: 200px;
			font-weight: bold;
			font-size: 40px;
		}
	</style>
</head>
<body>
	<input type="text">
	<script>
		var oInput = document.querySelector('input');

		function tumblrHandler(path){
			downloader(path);
		}

		function porn91Handler(path){
			var frame = document.createElement('iframe');
			frame.src = `https://www.alltubedownload.net/video?url=${encodeURIComponent(path)}&page=video`;

			frame.style.visiable = 'none';

			document.body.appendChild(frame);

			frame.onload = function(){
				// TODO
			}
		}

		function downloader(path,name){
			var oA = document.createElement('a');
			oA.href = path;
			oA.download = name || true;

			oA.click();
		}

		window.onfocus = function(){
			// console.log('focus now')
		}

		window.onblur  = function(){
			// console.log('blur!');
		}

		window.onkeydown = function(ev){
			if( ev.metaKey && ev.keyCode == 86 ){
				oInput.focus();
			}
		}

		window.onkeyup = function(ev){
			var path = oInput.value;

			if( /tumblr/.test(path) ){

				tumblrHandler(path);

			} else if( /91porn/.test(path) ){
				porn91Handler(path);
			} else {
				console.warn('unsupported site');
			}

			oInput.blur();
		}
	</script>
</body>
</html>